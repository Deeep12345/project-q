<!DOCTYPE html>
<!--  Last Published: Fri Apr 03 2020 09:03:35 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e841deb90c306a2f07b8d3b" data-wf-site="5e7b9ae24c46c726e716ecf3">

<head>
  <meta charset="utf-8">
  <title>Project Q</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/project-queue.webflow.css" rel="stylesheet" type="text/css">
  <script src="../js/angular.min.js" type="text/javascript"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="apple-touch-startup-image" href="images/splash/launch_640x1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch_750x1294.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch-1242x2148.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch_1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch_1536x2048.png" media="(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch_1668x2224.png" media="(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="images/splash/launch_2048x2732.png" media="(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <script src="/js/angular-cookies.min.js" type="text/javascript"></script>
  <script src="/js/texts-location.js" type="text/javascript"></script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">
    ! function (o, c) {
      var n = c.documentElement,
        t = " w-mod-";
      n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
    }(window, document);
  </script>
  <link href="../images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon">
  <style rel="stylesheet">
    .waiting {
      width: 100%;
      position: absolute;
      height: 100%;
      top: 0px;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      left: 0px;
    }

    .waiting>span {
      width: 7px;
      height: 7px;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      background-color: #fff;
      margin: 0 5px;

      border-radius: 50%;
      display: inline-block;
      animation-name: dots;
      animation-duration: 2s;
      animation-iteration-count: infinite;
      animation-timing-function: ease-in-out;
    }

    .waiting span:nth-child(2) {
      animation-delay: 0.4s;
    }

    .waiting span:nth-child(3) {
      animation-delay: 0.8s;
    }

    @keyframes dots {
      50% {
        opacity: 0;
        transform: scale(0.7) translateY(10px);
      }
    }

    @media only screen and (max-width: 768px) {
      span.w-form-label.cb-label {
        font-size: 18px !important;
      }
    }

    @media only screen and (max-width: 479px) {
      span.w-form-label.cb-label {
        font-size: 12px !important;
      }
    }
  </style>
</head>

<body class="body" ng-app="locApp" ng-controller="locCtrl">
  <div class="main_div">
    <div class="header_div">
      <div class="div-block-20">
        <h1 class="heading-3" ng-cloack>{{texts.heading_3}}</h1>
      </div>
    </div>
    <div class="div-block-21">
      <div class="form-block-2 w-form">
        <form data-redirect="https://q.spation.co/it/main" redirect="https://q.spation.co/it/main" data-name=""
          method="get" class="form-2">
          <input type="text" ng-model="streetName" class="text-field-3 w-input" autofocus="false" maxlength="256"
            name="User-address" data-name="User address" placeholder="{{texts.placeholder_1}}" id="User-address-4"
            required="">
          <input type="text" ng-model="zipCode" class="text-field-3 w-input" autofocus="false" maxlength="256"
            name="Zip-Code" data-name="Zip Code" placeholder="{{texts.placeholder_2}}" id="Zip-Code" required="">
          <input type="text" ng-model="city" class="text-field-3 w-input" autofocus="false" maxlength="256" name="City"
            data-name="City" placeholder="{{texts.placeholder_3}}" id="City" required="">
          <input type="text" ng-model="country" class="text-field-3 w-input" autofocus="false" maxlength="256"
            name="Country" data-name="Country" placeholder="{{texts.placeholder_4}}" id="Country" required="">
          <div>
            <p class="paragraph-4" style="margin-top: 15px;" ng-cloack>{{texts.paragraph_4}}</p>
            <label class="w-checkbox checkbox-field" style="margin-top: 15px;"><input type="checkbox"
                ng-model="doesAgree" class="w-checkbox-input"><span class="checkbox-label w-form-label cb-label" ng-cloack>{{texts.checkboxlabelwformlabelcblabel}}</span></label>
          </div>
        <div class="addressRelevanceIsLow" ng-if="shouldUserVerify" ng-cloak>
          "{{userAddress}}"{{texts.addressRelevanceIsLow}} 
          <a href="#" ng-click="clear()" ng-cloak>{{texts.notCorrect}}</a>
        </div>
          <button ng-click="getAddress()" class="submit-button w-button" style="position: relative;"
            ng-style="{height: loading ? '42px' : 'auto'}">
            <div ng-if="loading" class="waiting">
              <span></span>
              <span></span>
              <span></span>
            </div>
            <span ng-if="!loading" i18n='Confirm' ng-cloak>{{texts.ngscope}}</span>
          </button>
        </form>
        
      </div>
    </div>
  </div>
  <div class="footer_section"></div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js?site=5e7b9ae24c46c726e716ecf3"
    type="text/javascript" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <div>
  </div>
  <script type="text/javascript">
    var app = angular.module('locApp', ['ngCookies', 'textsLocation']);
    app.controller("locCtrl", function ($scope, $http, $cookies, $window, lang) {

      var language = $window.navigator.userLanguage || $window.navigator.language;
      console.log(language);
      switch (language) {
        case "it-IT" || "it" :
          language = "it";
          //console.log("language: italian");
          break;
        case "en-US" || "en-UK" || "en" :
          language = "en";
          //console.log("language: english");
          break;
        case "fr-FR" || "fr" :
          language = "fr";
          //console.log("language: french");
          break;
        case "es-ES" || "es":
          language = "es";
          //console.log("language: spanish");
          break;
        default:
          language = "en";
          //console.log("language: deafault");
      }
      $scope.texts = lang[language];
      if (!$scope.texts) {
      $scope.texts = lang.en;
      }

      $scope.userAddress = "";
      $scope.streetName = "";
      $scope.zipCode = "";
      $scope.country = "";
      $scope.city = "";
      $scope.buttonText = "Conferma";
      $scope.path = (address) => {
        return `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURI(address)}.json?types=address&access_token=pk.eyJ1IjoicXNwYXRpb24iLCJhIjoiY2s4MW85cm50MGJjdjNmbDkxZmtwY2ExbyJ9.qi-2tdukdDJhH7kZWttiRA`;
      };
      $scope.loading = false;
      $scope.clear = () => {
        $scope.buttonText = 'Conferma';
        $scope.streetName = '';
        $scope.zipCode = '';
        $scope.city = '';
        $scope.country = '';
        $scope.shouldUserVerify = false;
      };
      $scope.getAddress = async () => {
        $scope.userAddress = `${$scope.streetName}, ${$scope.zipCode}, ${$scope.city}, ${$scope.country}`;
        
          $scope.loading = true;
          var res = await $http.get($scope.path($scope.userAddress));
          $scope.$apply(() => {
            var features = res.data.features;
            $scope.loading = false;
            features.sort((a, b) => {
              a.relevance < b.relevance ? 1 : -1;
            });
            if (features[0] && features[0].relevance > 0.8 || $scope.shouldUserVerify) {
               $scope.userAddress = features[0].place_name;
               var date = new Date();
              if ($scope.doesAgree) {
                date.setMonth(date.getMonth() + 3);
                $cookies.put("qspationUserAddress", $scope.userAddress, { expires: date.toUTCString() });
              } else {
                $cookies.remove("qspationUserAddress");
                sessionStorage.setItem('qspationUserAddress', $scope.userAddress);
              }
              $window.location.href = '/list';
            } else {
              $scope.userAddress = features[0].place_name;
              $scope.shouldUserVerify = true;
            }
           
          });
        
      };

    });
  </script>
</body>

</html>